# Deep Autoencoding Models for UnsupervisedAnomaly Segmentation in Brain MR Images(2018)

## 摘要
1.以前的基于无监督异常检测的方法有基于统计学习的，基于上下文检索，聚类和深度学习的。
2.GAN或者AE的变体都是学习正常的image patch的特征，然后从学习到的特征空间或者大的重构误差中检测异常。
3.该论文表明深度空间自动编码器能够用于捕获整个2D图像，并用输入图片与重构图片的残差图进行比较来检测异常。
4.结论：对隐空间和对对抗训练进行限制可以进一步提高分隔性能。

## intruduction
1.基于监督学习的方法需要大量的标注样本，数据的获取或者标注都相当困难，耗时耗力。而且，标注的只是对于大部分的病理特征进行标注，对于其他的一些特殊情况，则会遇到问题，泛化性能差；

2.比较了AE和GGAN的思路，并将他们结合在一起，具体过程：

	1.AE能够利用原图与重构图的残差来生成高分辨率的图片;缺点是生成的图像模糊。
	2.Gan利用对抗训练能生成真实的图片，缺点是：训练不稳定，容易产生模式坍塌。
	3.将两者结合起来得到VAEGAN.
3.contribution:

	1.Anogan主要应用在基于image patch的小分辨的场景，无法生成复杂且高分辨的图片；并且在每次测试时候需要迭代，非常耗费时间；
	2.为了避免anogan的问题，作者利用空间VAE(spatial VAEs)形式的深度生成模型 构建一个捕捉全局信息而不是局部信息的模型；
	3.为了避免AE的记忆陷阱并提高重构样本的真实性，在对抗网络的帮助下训练网络的解码器部分，最终模型转化为VAEGAN	.

## method
	1.限制正常隐空间多变量的高斯正态分布(multivariate normal distribution).
	2.encoder-decoder采用完全卷积的架构来保存latent space的空间信息；

###anomaly detection
	1.计算输入图片和重构图片像素的L1距离；
	2.对残差图片阈值化来获得二分类图片；

## 4.experiments andresults
	研究内容如下：	
	1.deep autoencoding networks是否可以有效的重构复杂的MR图片;
	2.隐变量z的维度如何影响模型的重构能力；
	3.the effect of constraining z to be well structured(约束z结构良好的效果)
	4.对抗训练是否会增加图像质量.

### 1.anomaly detection
	1.先用512维的隐空间在正常的 conv AE & VAE进行训练。结果：模型不能重构大脑损伤，也缺乏重构精细(fine detail)细节的能力；	
	2.第二次是将architecture 变成完全卷积的来确保空间信息不会丢失，这增大了z的维度；因此，改变了spatial AE的特征图的数量，来研究z的维度对正常和异常样本的重构能力；最后z=16x16x64
### 2.postprocess
	1.利用5x5x5的中值滤波器，以滤除属于大脑卷积的小残差；	
	2.将残差与轻微腐蚀的大脑掩模相乘，对所得体积进行阈值化以获得二进制分割掩模，并移除面积小于6个体素的微小3D连接组件，因为它们不太可能构成病变。
	3.阈值是特定于模型的，并被确定为训练数据集上模型重建误差的第98个百分点,我们根据经验从正常和异常数据获得的残差直方图中选择这个百分位数.
	4.
